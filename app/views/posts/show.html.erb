<div class="post-detail-container">
  <article class="post-card post-card-detail">
    <!-- Post Header -->
    <div class="post-header">
      <div class="post-author">
        <div class="author-avatar">
          <%= @post.user.username.first.upcase %>
        </div>
        <div class="author-info">
          <strong class="author-name"><%= @post.user.username %></strong>
          <span class="post-time"><%= time_ago_in_words(@post.created_at) %> ago</span>
        </div>
      </div>
      <% if logged_in? && (current_user == @post.user || current_user.admin?) %>
        <div class="post-menu">
          <button class="post-menu-btn">⋯</button>
          <div class="post-menu-dropdown">
            <% if current_user == @post.user %>
              <%= link_to 'Edit', edit_post_path(@post), class: 'post-menu-item' %>
            <% end %>
            <%= link_to 'Delete', post_path(@post), 
                data: { turbo_method: :delete, turbo_confirm: 'Are you sure?' }, 
                class: 'post-menu-item post-menu-item-danger' %>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Post Image -->
    <% if @post.image_url.present? %>
      <div class="post-image-container">
        <img src="<%= @post.image_url %>" alt="<%= @post.title || 'Post image' %>" class="post-image">
      </div>
    <% end %>

    <!-- Post Content -->
    <div class="post-body">
      <% if @post.title.present? %>
        <h1 class="post-title"><%= @post.title %></h1>
      <% end %>
      <% if @post.content.present? %>
        <div class="post-content"><%= simple_format(@post.content) %></div>
      <% end %>
    </div>

    <!-- Reactions -->
    <% if logged_in? %>
      <%= render 'posts/reactions', post: @post %>
    <% else %>
      <div class="reactions-container">
        <div class="reactions-summary">
          <% total_reactions = @post.reactions.count %>
          <% if total_reactions > 0 %>
            <span class="reactions-text"><%= pluralize(total_reactions, 'reaction') %></span>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Comments Section -->
    <div class="comments-section">
      <h3 class="comments-title">Comments</h3>
      
      <div class="comments-list">
        <% if @post.comments.any? %>
          <% @post.comments.each do |comment| %>
            <%= render 'comments/comment', comment: comment %>
          <% end %>
        <% else %>
          <p class="no-comments">No comments yet. Be the first to comment!</p>
        <% end %>
      </div>

      <!-- Comment Form -->
      <%= render 'comments/form' %>
    </div>
  </article>

  <div class="post-detail-actions">
    <%= link_to posts_path, class: 'btn btn-back' do %>
      ← Back to Feed
    <% end %>
  </div>
</div>
